log:
  # Set the log level. Supported levels:
  #
  # - trace
  # - debug
  # - info
  # - warn
  # - error
  # - fatal
  # - panic
  #
  level: "error"
# OpenTelemetry support.
opentelemetry:
  enabled: true
  # Configure open telemetry to connect to a collector with the grpc URL. If
  # not set, ncps will simply print telemetry to stdout which is not very
  # useful but can be helpful for debugging.
  grpc-url: "http://otelcol-collector.monitoring.svc:4317"
# Prometheus metrics exposed at /metrics on the same port as ncps
prometheus:
  enabled: true
# Configure the cache functionality.
cache:
  # Whether to allow the DELETE verb to delete narInfo and nar files
  allow-delete-verb: true
  # Whether to allow the PUT verb to push narInfo and nar files directly
  allow-put-verb: true
  # The hostname of the cache server
  hostname: "ncps.mycompany.tld"
  # The local data path used for configuration and cache storage
  # Use this OR S3 storage (storage.s3.bucket) - not both
  data-path: "/var/lib/ncps"

# S3 Storage configuration (alternative to cache.data-path)
# Use this for storing cache data in S3-compatible storage (AWS S3, MinIO, etc.)
storage:
  s3:
    # S3 bucket name (use this OR cache.data-path - not both)
    # bucket: "ncps-cache"
    # S3-compatible endpoint URL (e.g., s3.amazonaws.com or minio.example.com:9000)
    # endpoint: "s3.amazonaws.com"
    # AWS region (optional)
    # region: "us-east-1"
    # S3 access key ID
    # access-key-id: "your-access-key"
    # S3 secret access key
    # secret-access-key: "your-secret-key"
    # Use SSL/TLS for S3 connection (default: true)
    # use-ssl: true
  # The URL of the database
  database-url: "sqlite:/var/lib/ncps/db/db.sqlite"
  # The maximum size of the store. It can be given with units such as 5K, 10G
  # etc. Supported units: B, K, M, G, T
  max-size: 100G
  # Configure the LRU to clean the store and purge least used nars. No nars are
  # removed unless the size approaches max-size.
  lru:
    # The cron spec for cleaning the store. Refer to
    # https://pkg.go.dev/github.com/robfig/cron/v3#hdr-Usage for documentation
    schedule: "0 0 * * *"
    # The name of the timezone to use for the cron
    timezone: America/Los_Angeles
  # The path to the secret key used for signing cached paths
  # XXX: Only set this if you intend to store the key yourself instead of having ncps store it in its config store.
  secret-key-path: ""
  # Whether to sign narInfo files or passthru as-is from upstream
  sign-narinfo: true
  # The path to the temporary directory that is used by the cache to download NAR files
  temp-path: "/tmp"
  # Path to netrc file for upstream authentication
  netrc-file: "/etc/ncps/netrc"
  # Configure upstream caches
  upstream:
    # Set to URL (with scheme) for each upstream cache
    caches:
      - https://cache.nixos.org
      - https://nix-community.cachix.org
    # Set to host:public-key for each upstream cache
    public-keys:
      - cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY=
      - nix-community.cachix.org-1:mB9FSh9qf2dCimDSUo8Zy7bkq5CX+/rkCWyvRCYg3Fs=
# Configure the main server
server:
  # The address of the server
  addr: ":8501"
