# Negative test: Migration with initContainer mode and multiple replicas
# This should FAIL validation - initContainer risks database corruption with HA
mode: deployment
replicaCount: 2

migration:
  enabled: true
  mode: initContainer

config:
  hostname: "test.example.com"

  storage:
    type: s3
    s3:
      bucket: my-bucket
      endpoint: https://s3.amazonaws.com
      region: us-east-1
      accessKeyId: test-key
      secretAccessKey: test-secret

  database:
    type: postgresql
    postgresql:
      host: postgres.example.com
      database: ncps
      username: ncps
      password: secret

  redis:
    enabled: true
    addresses:
      - redis:6379
