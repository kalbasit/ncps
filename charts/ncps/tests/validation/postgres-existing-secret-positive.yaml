# Positive test: PostgreSQL with existingSecret containing database-url
# Secret must have 'database-url' key with full connection string
mode: deployment
replicaCount: 3

config:
  hostname: "test.example.com"

  storage:
    type: s3
    s3:
      bucket: test-bucket
      endpoint: https://s3.amazonaws.com
      region: us-east-1
      accessKeyId: test-key
      secretAccessKey: test-secret

  database:
    type: postgresql
    postgresql:
      # These fields are ignored when using existingSecret
      # The connection details come from the secret's database-url key
      host: ignored
      existingSecret: pg-creds

  redis:
    enabled: true
    addresses:
      - redis:6379

migration:
  mode: job
